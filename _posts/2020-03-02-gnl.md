---
layout: post
title: '[42] get_next_line 메모'
date: 2020-03-03 19:20:35 +0900
category: '[42]GNL'
---
- 메모리 릭에 주의해야 한다. 메모리를 할당한 부분을 주의깊게 보면서 디버깅을 진행함. 컴파일 시 메모리 릭을 직접 확인하는 방법
```c
system(“leaks a.out > leaks_result_temp; cat leaks_result_temp | grep leaked && rm -rf leaks_result_temp”);
```
메인함수 코드에서 return 전 부분에 위 코드를 삽입하면 존재하는 메모리 릭을 확인할 수 있다. 

- 기존 코드에서는 readsize가 0일 때 멈추도록 짜놨는데, 만약 EOF까지 read를 완료하여 readsize가 0이지만 backup[fd]에 개행이 포함된 문자열이 남아있는 경우에 그대로 남은 문자열을 `*line`에 주고 `return 0`을 하고 만다. 그 부분이 잘못된 부분이었다
--> while문을 빠져나가지 않도록 수정하고 (`while (readsize <= 0)` EOF를 만났을 때 자체적으로 while문 안에서 `return (0)`하여 나오도록 코드를 수정하였다. -`if(readsize < BUFFER_SIZE)`- input 값이 정상적일 경우 첫번째 if문에서 return 1로 종료되거나 두번째 if문에서 return 0으로 끝날것이기 때문에 while 조건에서 멈춤을 고려하지 않아도 된다. 

### 최종코드
```c
```

- 테스터 
	- [gnl-war-machine-v2019](https://github.com/C4r4c0l3/gnl-war-machine-v2019.git) (V)
	- [42TESTERS-GNL](https://github.com/Mazoise/42TESTERS-GNL.git) (V)
	- [GNL_lover](https://github.com/charMstr/GNL_lover.git) (V)
	- [gnlkiller](https://github.com/DontBreakAlex/gnlkiller.git) (V)
	- [42cursus_gnl_tests](https://github.com/mrjvs/42cursus_gnl_tests.git) (V)
	- [Get_Next_Line_Tester](https://github.com/Hellio404/Get_Next_Line_Tester.git) (V) - 메모리릭 체크에 good